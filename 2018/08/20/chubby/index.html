<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>












    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            Chubby：分布式，去耦合，工程与妥协。 | 
        
        Saigyouji-Yuyuko
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.jpg">
    <link rel="icon" href="/img/favicon.jpg">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content=",分布式,paper">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?ezyEvm8ST5CGfpA+kFFi1g==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Saigyouji-Yuyuko">
    <meta name="msapplication-starturl" content="https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Saigyouji-Yuyuko">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.jpg">

    <!-- Site Verification -->
    <meta name="google-site-verification" content="DwwG3JWiNomzXkgw1s-KGkfaDLK5drHon53Z8SMMpeU" />
    <meta name="baidu-site-verification" content="zcvfYJ5jen" />

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Chubby：分布式，去耦合，工程与妥协。 | Saigyouji-Yuyuko">
    <meta property="og:image" content="/img/favicon.jpg">
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="分布式"> <meta property="og:article:tag" content="paper"> 

    
        <meta property="article:published_time" content="Mon Aug 20 2018 22:54:34 GMT+0800">
        <meta property="article:modified_time" content="Tue Aug 21 2018 03:34:20 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/index.html",
    "headline": "Chubby：分布式，去耦合，工程与妥协。",
    "datePublished": "Mon Aug 20 2018 22:54:34 GMT+0800",
    "dateModified": "Tue Aug 21 2018 03:34:20 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Saigyouji-Yuyuko",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.jpg"
        },
        "description": "FREEDOM IS NOT FREE"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Saigyouji-Yuyuko",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.jpg"
        }
    },
    "keywords": ",分布式,paper",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    
        <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1273677710&web_id=1273677710" language="JavaScript"></script>
</div>
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#设计目标"><span class="post-toc-number">1.</span> <span class="post-toc-text">设计目标</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#实现设计"><span class="post-toc-number">2.</span> <span class="post-toc-text">实现设计</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#总结与展望"><span class="post-toc-number">3.</span> <span class="post-toc-text">总结与展望</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考"><span class="post-toc-number">4.</span> <span class="post-toc-text">参考</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(/gallery-data/photo_2018-04-16_02-46-23.jpg)">
    
            <p class="article-headline-p">
                Chubby：分布式，去耦合，工程与妥协。
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Saigyouji-Yuyuko</strong>
        <span>8月 20, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC30lEQVR42u3aW44aMRAFUPa/6WQBEcy9ZUhI+fgLNT3dPkaaUj0ev65cD2xsbGxsbGxsbOyvZD/i9eyvkivPvn32+c83vmHP2NjY2KvZP/zrj+9JNvHsEJ9dSe5P9oyNjY19AzsPNnlgSw4oP4LZnrGxsbGxk1QhuZ5QX9+JjY2Njf0Jdp5I5MHv/JnY2NjYd7KTAs15EpKXjXLSx2tp2NjY2F/PnhX3/+3nv9rfxsbGxv5idrvaQNU+efbG6PnY2NjYS9l5YDhHPo7X0T6xsbGxl7Lz0s/roNImBsnzkzcWe8bGxsZezU42l7d43zVAmYOjBgY2Njb2Bey2xdtuMT/QpN2bHys2Njb2bex8LHJWAMqLTSdvwcbGxr6N3ZaNZgeXJzZtMhNdx8bGxl7NnpFODiJvEueJyjAVwcbGxv7P2SeJRx7qZqM5SbpSDAxhY2NjL2Xngzt5WSdv+r43NP6QzGBjY2MvZeeDMm0p6hw8KzNFRSVsbGzsRew2gM0GcXJM/pPkR4aNjY19Azsv0ye89v6ckYdVbGxs7HvYs2HHdosnKUrbeCi6ItjY2NhL2Un6kTcJ2kDYDv0U40HY2NjYS9l5KJptNNpQOabTtiKwsbGxd7NngWF2EHkBa5ao1HEbGxsbewU7LzDNNpGHyTwsDUc2sbGxsZeyZ688SRLyJCS/ErV+sbGxsS9g5yEtSUJmpasitQh+GGxsbOyb2W0aMAsz7bdJaDyqpWFjY2MvYudJxUljuC1mzYY7sbGxsXez23VeJHpdisqDZZ0IYWNjYy9ln4SEtgXbbjdvMEdvxMbGxl7NPinrJ6lL3gzOGa+PDxsbG/tO9ixJyNsDJ63ffFSoSEWwsbGxr2fXQzNvClTDBjA2NjY2drzFtn2bD/HkbYmPpCLY2NjYX8/+XHM3D3LtnUVShI2Njb2aPSvc5AlJ8sz2yXWahI2Njb2Ufc/CxsbGxsbGxsbG/pr1G94lAZOiarPCAAAAAElFTkSuQmCC">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/paper/">paper</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/分布式/">分布式</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Chubby：分布式，去耦合，工程与妥协。&url=https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/index.html&pic=https://Saigyouji-Yuyuko.github.io/img/favicon.jpg&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Chubby：分布式，去耦合，工程与妥协。&url=https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/index.html&via=Saigyouji-Yuyuko" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/index.html&text=Chubby：分布式，去耦合，工程与妥协。" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>首先，论文地址：<a href="http://static.usenix.org/legacy/events/osdi06/tech/full_papers/burrows/burrows.pdf" target="_blank" rel="noopener">The Chubby lock service for loosely-coupled distributed system</a>  </p>
<p>这篇paper论述了一些chubby实现上除了paxos以外的一些设计，关于paxos的设计与取舍上是另外一篇论文，链接在此：<a href="http://www8.cs.umu.se/kurser/5DV153/HT14/literature/chandra2006paxos.pdf" target="_blank" rel="noopener">Paxos made live: an engineering perspective</a>（以后会补一个阅读笔记）。其实我最开始读的是讲paxos算法的论文，chubby我一直没读，我当时搜了下chubby大概的功能，觉得搞清paxos大概就差不多可以搞个这样的差不多功能的错觉（不就是个paxos + KV吗，拍飞）。。。。昨天读了一下这篇，发现教我做人了。。。。怂了怂了。。。读完之后我就有一个感觉，工程是拖鞋，啊呸，妥协的艺术。。。。  </p>
<h2 id="设计目标"><a href="#设计目标" class="headerlink" title="设计目标"></a>设计目标</h2><p>chubby开篇就说是一个分布式的锁服务。什么是锁，锁其实是一个排他性的独占时间的一个举措。分布式一致性总的来说就是一个时间重排的问题，不同的时间发生的时间应该怎么依次发生？而锁应该是一种比较粗暴的玩法，所有事件都只能通过持有锁的方式来排序。也就是锁的获取顺序来决定事件的时间排序。<br>chubby通过引入锁的抽象来帮助开发者快速做到分布式开发，文章讲了几个理由，我总结一下：</p>
<ul>
<li><p>开发者不需要读一打paxos made xxx 再来写应用，也不需要在代码里搞一堆兼容一致性协议库的东西，从单机一步升级到分布式！surprise！</p>
</li>
<li><p>去耦合，搞个外部的锁，出了啥问题，搞外部锁就可以了，不会影响其他开发者代码，升级也方便！wonderful！  </p>
</li>
</ul>
<p>其他的好处就算了，name server其实算个添头，至于减少客户的服务器数量我是不这么看的，你分布式至少要有两个服务器把？只有一个算J8分布式？两个服务器可以组主备复制（primary-backup）啊。当然其实这样就复杂了，可能出现多种协议。当然天下没有白得的午餐，好事不能让你占尽了。如果你的操作频繁需要通过一致性协议确认，性能肯定是远远不如直接使用一致性协议的，那咋办？不通过别。chubby鼓励粗粒度锁(Coarse-grained)而不是细粒度锁(Fine-grained)就是因为一致性频繁通过chubby确认的话，性能会比较感人。至于说细粒度可以通过粗粒度模拟也是好处就是扯淡了，粗粒度不能通过细粒度模拟？  </p>
<h2 id="实现设计"><a href="#实现设计" class="headerlink" title="实现设计"></a>实现设计</h2><p>chubby cell之间是通过multi-paxos之间确保数据的一致性。老规矩，只有master能够读写（如果使用epaxos等无master协议会不会有性能优化？）master通过租约来维持身份，租约多久超时之后就重新选举，反正套路都基本一样。。  </p>
<p>chubby 通过Unix的文件格式来暴露对外的接口，我觉得这个点就很有意思。我在这里不会讨论文中的通过文件暴露接口的具体细节。但是这确实是个很有意思的玩法。其实设计我觉得分两个部分，一个是服务的逻辑组织通过Unix的文件与目录的关系来阻止。一个是通过文件描述法(file descriptor)来表达接口。后者其实还好，可以理解为对开发者的友好，或者说前者的附带品。通过文件与目录的关系表达锁之间的关系。给跨服务之间的transaction其实做好了铺垫。其实不要以为目录表达很直观。。。。底层作为KV，实现目录其实本身是增加了麻烦的。。。。至于什么目录的各种属性，临时文件，永久文件，看看就行了。。。。</p>
<p>下面具体讨论分布式锁的问题，我们知道，分布式稳定的状态就是不稳定。那么不稳定，很多通信，节点都是不稳定的。但是我们又要保证一致。怎么搞？文中提出两个方法：</p>
<ul>
<li><p>搞一个Sequencer。然后拿到锁的服务拿着这个Sequencer到处比较，发现失效了就代表锁没了。同理，把这个Sequencer搞失效也意味着这锁没了。</p>
</li>
<li><p>lock delay 异常丢锁之后，一定时间内不允许其他节点加锁，这样可以避免一些尚在活动的操作和新锁带来的新操作相互覆盖而不一致。  </p>
</li>
</ul>
<p>paper认为第一种是一种更好的方法，不错Sequencer确实是个更严谨的方法，不会带来额外的不可用。但是Sequencer实际上是加了一重耦合。无非是服务的上层拿住校检或者下层拿住校检。实际上是要对服务来进行额外的与chubby耦合。。。。而第二种拿available换了consistent，但我觉得更好，虽然paper认为这是个妥协的办法，但是如果对于每个任务都有一个超时上线的话，我觉得这种办法具有更好的普适性，去掉了上下层的耦合（我们的需求是不能有耦合。。。），当然你API幂等就皆大欢喜了。。  </p>
<p>Cache的是玩法我觉得最重要的还是失效与恢复机制，正好与chubby失效恢复机制和cache更新机制结合起来，这个有点意思，可以想下为啥是cache失效而不是其他办法。分布式系统的故障恢复肯定是个核心的问题。。我觉得他的恢复机制还是有点繁琐与复杂了，他自己后面也承认了。。。而且我也没搞懂为啥要阻塞keepalive，为什么不把定时器做到server里，chubby维护那么多阻塞的keepalive是否有必要？只要把时间差打好我觉得放那里都可以吧？  </p>
<p>数据库之类的写什么的是肯定可以极大地优化空间的，但是问题是这只能结合运用来具体展开，对着paper没啥好说的，，，，后面说keepalive流量恐怖。。如果要跟新个版本号之类的，写还是蛮恐怖的。。虽然提到了不及时更新keepalive数据，但是终究治标不治本。。</p>
<p>后面展开讲了下工程问题，优化上提到了代理(proxy)和分区(partitioning),这两个都是讲起来简单，实际上做起来非常感人的东西，不要看paper中轻描淡写，其实绝壁是坑，proxy与多个chubby之间的缓冲一致性的维护？proxy挂掉了之后，客户与chubby直连之后数据不一致的更新，反正绝壁坑。至于partitioning那就是坑中之坑，迁移肯定是动态得把，多个chubby cell之间参与把，分布式事务怎么维持？坑中之坑。。。。</p>
<h2 id="总结与展望"><a href="#总结与展望" class="headerlink" title="总结与展望"></a>总结与展望</h2><p>chubby的作者自己也承认自己是把现有的技术整合起来，而不是搞出来啥新技术。但是所谓工程也就是如此，工程更多强调对现有技术的整合与取舍（当然正确性是第一位的）。回顾全文，我们处处能看到取舍，妥协，去耦合。天下没有白得的午餐，CAP不能全站，你想cache加快，就可能导致数据不一致。你想Sequencer就得上下层加耦合。你想更好的性能就别用锁直接上一致性协议。很多分布式工程实际上都是如此取舍。  </p>
<p>其实可以更深入一点，往往就是乐观锁与悲观锁的区别。乐观提升平时性能，但是出了点error就可能异常麻烦，甚至导致长时间不可用。悲观的话就是平时性能差点，当时保证出事就不慌了，看你怎么求取舍。。。。所谓减少系统通信次数来性能优化不过就是乐观玩法，出事了可能造成的不可用时间也会变长。。而lock delay就是悲观玩法，通过放弃一定性能来保证consistent。。。。  </p>
<p>有人认为<a href="http://catkang.github.io/2017/09/29/chubby.html" target="_blank" rel="noopener">责任分散</a>也是一个特点。。。我是没感觉出来。。他说的故障恢复我比较同意，不一定要全持久化加重disk负担，但是我们也知道这是提高平时的效率，降低恢复时的效率的乐观玩法。。。。。</p>
<p>chubby提供了一个分布式的锁机制，大家一般都通过它来master select或者name server。回到最开始，最基础其实consistent protocol + kv ，但是这样设计的话可用性大概约等于0把。。。。。。文章讨论了很多工程中的优化，使得我做一个这个成了可能（大坑）。不过chubby的持久化结构其实paper没有提，我感觉这不是个简单东西。。。</p>
<p>chubby后来有zookeeper学他搞了自己一套，不过这玩意，正确性也确实很难保证。最好的方法肯定是TLA+之类的，但是难度太大。据说Amazon S3\ebs ，MS的cosmos都通过了证明。。zookeeper破司据说就被坑过两次。。。所以没事别自己瞎搞，别想不开。。。。。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><p><a href="http://static.usenix.org/legacy/events/osdi06/tech/full_papers/burrows/burrows.pdf" target="_blank" rel="noopener">The Chubby lock service for loosely-coupled distributed system</a>  </p>
</li>
<li><p><a href="http://www8.cs.umu.se/kurser/5DV153/HT14/literature/chandra2006paxos.pdf" target="_blank" rel="noopener">Paxos made live: an engineering perspective</a>  </p>
</li>
<li><p><a href="http://catkang.github.io/2017/09/29/chubby.html" target="_blank" rel="noopener">Chubby的锁服务</a>  </p>
</li>
<li><p><a href="http://baotiao.github.io/2017/09/12/distributed-lock/" target="_blank" rel="noopener">talk about consensus algorithm and distributed lock</a></p>
</li>
</ul>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 DISQUS -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'https://Saigyouji-Yuyuko.github.io/2018/08/20/chubby/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>
<script type="text/ls-javascript" id="disqus-thread-script">
    queue.offer(function() {
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document;
                var s = d.createElement('script');
                s.src = '//blog-3pgvTI5x1r.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        });
</script>

</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/05/11/hello-world/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/20141116132053_VGeya.jpeg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.jpg" alt="Saigyouji-Yuyuko's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: tanlinshishian@163.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
            <li class="divider"></li>
        
    
        <li>
            <a href="/timeline" title="时间线">
                
                    <i class="material-icons sidebar-material-icons">query_builder</i>
                
                时间线
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="Tags">
                
                    <i class="material-icons sidebar-material-icons">bookmark</i>
                
                Tags
            </a>
        </li>
        
    
        <li>
            <a href="/gallery" title="收图">
                
                    <i class="material-icons sidebar-material-icons">filter</i>
                
                收图
            </a>
        </li>
        
    
        <li>
            <a href="/reading" title="Reading list">
                
                    <i class="material-icons sidebar-material-icons">book</i>
                
                Reading list
            </a>
        </li>
        
    
        <li>
            <a href="/money" title="我很可爱，请给我钱">
                
                我很可爱，请给我钱
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">2</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

    <a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.help
        <span class="mdl-button__ripple-container">
          <span class="mdl-ripple"></span>
        </span>
      </div>
    </a>

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    
        <a href="https://weibo.com/u/5238757966" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/Saigyouji-Yuyuko" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/Saigyouji-Yuyuko/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
        <a href="https://telegram.me/Saigyouji%20Yuyuko" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-telegram">
                <span class="visuallyhidden">Telegram</span>
            </button><!--
     --></a>
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2018&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Saigyouji-Yuyuko
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?wgjW/HuQG9JDgvPDPoRAng==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?tNQK2Tw2SUL8a1Scn/Mgew==", true)</script>
    





    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- 使用 DISQUS js 代码 -->
<script id="dsq-count-scr" src="//blog-3pgvTI5x1r.disqus.com/count.js" async></script>





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
